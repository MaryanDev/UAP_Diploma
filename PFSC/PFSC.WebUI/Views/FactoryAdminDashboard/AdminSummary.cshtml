@model PFSC.Models.FactoryAdminDashboard.DashboardModel
<div class="container-fluid">

    <div class="row page-titles">
        <div class="col-md-5 align-self-center">
            <h3 class="text-themecolor">Головна</h3>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Домашня</a></li>
                <li class="breadcrumb-item active">Головна</li>
            </ol>
        </div>
        @*<div class="col-md-7 align-self-center">
                <a href="https://wrappixel.com/templates/adminwrap/" class="btn waves-effect waves-light btn btn-info pull-right hidden-sm-down"> Upgrade to Pro</a>
            </div>*@
    </div>

    <div class="row">
        <!-- Column -->
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex no-block">

                        <div>
                            <h5 class="card-title m-b-0">Графіки</h5>
                        </div>
                        <div id="lineChart" style="height: 350px; width: 100%;">

                        </div>
                        @*<div class="ml-auto">
                                <ul class="list-inline text-center font-12">
                                    <li><i class="fa fa-circle text-success"></i> SITE A</li>
                                    <li><i class="fa fa-circle text-info"></i> SITE B</li>
                                    <li><i class="fa fa-circle text-primary"></i> SITE C</li>
                                </ul>
                            </div>*@
                    </div>
                    @*<div class="" id="sales-chart" style="height: 355px;"></div>*@
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex m-b-30 no-block">
                        <h5 class="card-title m-b-0 align-self-center">Відгуки</h5>
                        <div id="pieChartContainer" style="height: 350px; width: 100%;"></div>
                        @*<div class="ml-auto">
                                <select class="custom-select b-0">
                                    <option selected="">Today</option>
                                    <option value="1">Tomorrow</option>
                                </select>
                            </div>*@
                    </div>
                    @*<div id="visitor" style="height:260px; width:100%;"></div>*@
                    @*<ul class="list-inline m-t-30 text-center font-12">
                            <li><i class="fa fa-circle text-purple"></i> Tablet</li>
                            <li><i class="fa fa-circle text-success"></i> Desktops</li>
                            <li><i class="fa fa-circle text-info"></i> Mobile</li>
                        </ul>*@
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex">
                        <div>
                            <h5 class="card-title">Працівники</h5>
                        </div>
                        @*<div class="ml-auto">
                                <select class="custom-select b-0">
                                    <option selected="">January</option>
                                    <option value="1">February</option>
                                    <option value="2">March</option>
                                    <option value="3">April</option>
                                </select>
                            </div>*@
                    </div>
                    <div class="table-responsive m-t-20 no-wrap">
                        <table class="table vm no-th-brd pro-of-month">
                            <thead>
                                <tr>
                                    <th>Ім'я</th>
                                    <th>Позиція</th>
                                    <th>Зарплата</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var emp in Model.Employees)
                                {
                                    <tr>
                                        <td>
                                            <span class="round round-warning">
                                                @if (string.IsNullOrEmpty(emp.AvatarPath))
                                                {
                                                    <text>@emp.Name.ToUpper()[0]</text>
                                                }
                                                else
                                                {
                                                    <img src="@emp.AvatarPath" alt="@emp.Name" width="50">
                                                }
                                            </span>
                                            @emp.Name
                                        </td>
                                        <td>@emp.Position</td>
                                        <td>@emp.Salary</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                @*<div class="up-img" style="background-image:url(~/Content/Styles/factoryDahsboard/images/big/img1.jpg)"></div>*@
                <div class="card-body">
                    <h5 class=" card-title">Business development of rules</h5>
                    <span class="label label-info label-rounded">Technology</span>
                    @*<p class="m-b-0 m-t-20">Titudin venenatis ipsum aciat. Vestibu ullamer quam. nenatis ipsum ac feugiat. Ibulum ullamcorper.</p>
                    <div class="d-flex m-t-20">
                        <a class="link" href="javascript:void(0)">Read more</a>
                        <div class="ml-auto align-self-center">
                            <a href="javascript:void(0)" class="link m-r-10"><i class="fa fa-heart-o"></i></a>
                            <a href="javascript:void(0)" class="link m-r-10"><i class="fa fa-share-alt"></i></a>
                        </div>
                    </div>*@
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6 col-md-12">
            <div class="card card-body mailbox">
                <h5 class="card-title">Замовлення</h5>
                <div class="message-center ps ps--theme_default ps--active-y" data-ps-id="a045fe3c-cb6e-028e-3a70-8d6ff0d7f6bd">
                    @foreach (var order in Model.Orders)
                    {
                        <a>
                            <div class="btn btn-danger btn-circle"><i class="fa fa-link"></i></div>
                            <div class="mail-contnet">
                                <h5>@order.CustomerName</h5> <span class="mail-desc">@order.Description</span> <span class="time">@order.CreatedDate</span>
                            </div>
                        </a>
                    }
                    @*<a href="#">
                            <div class="btn btn-danger btn-circle"><i class="fa fa-link"></i></div>
                            <div class="mail-contnet">
                                <h5>Luanch Admin</h5> <span class="mail-desc">Just see the my new admin!</span> <span class="time">9:30 AM</span>
                            </div>
                        </a>
                        <a href="#">
                            <div class="btn btn-success btn-circle"><i class="fa fa-calendar-check-o"></i></div>
                            <div class="mail-contnet">
                                <h5>Event today</h5> <span class="mail-desc">Just a reminder that you have event</span> <span class="time">9:10 AM</span>
                            </div>
                        </a>
                        <a href="#">
                            <div class="btn btn-info btn-circle"><i class="fa fa-cog"></i></div>
                            <div class="mail-contnet">
                                <h5>Settings</h5> <span class="mail-desc">You can customize this template as you want</span> <span class="time">9:08 AM</span>
                            </div>
                        </a>
                        <a href="#">
                            <div class="btn btn-primary btn-circle"><i class="fa fa-user"></i></div>
                            <div class="mail-contnet">
                                <h5>Pavan kumar</h5> <span class="mail-desc">Just see the my admin!</span> <span class="time">9:02 AM</span>
                            </div>
                        </a>*@
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Відгуки</h5>
                    <ul class="feeds">
                        @*<li>
                                <div class="bg-light-info"><i class="fa fa-bell-o"></i></div> You have 4 pending tasks. <span class="text-muted">Just Now</span>
                            </li>
                            <li>
                                <div class="bg-light-success"><i class="fa fa-server"></i></div> Server #1 overloaded.<span class="text-muted">2 Hours ago</span>
                            </li>
                            <li>
                                <div class="bg-light-warning"><i class="fa fa-shopping-cart"></i></div> New order received.<span class="text-muted">31 May</span>
                            </li>
                            <li>
                                <div class="bg-light-danger"><i class="fa fa-user"></i></div> New user registered.<span class="text-muted">30 May</span>
                            </li>
                            <li>
                                <div class="bg-light-inverse"><i class="fa fa-bell-o"></i></div> New Version just arrived. <span class="text-muted">27 May</span>
                            </li>
                            <li>
                                <div class="bg-light-info"><i class="fa fa-bell-o"></i></div> You have 4 pending tasks. <span class="text-muted">Just Now</span>
                            </li>
                            <li>
                                <div class="bg-light-danger"><i class="fa fa-user"></i></div> New user registered.<span class="text-muted">30 May</span>
                            </li>
                            <li>
                                <div class="bg-light-inverse"><i class="fa fa-bell-o"></i></div> New Version just arrived. <span class="text-muted">27 May</span>
                            </li>
                            <li>
                                <div class="bg-light-primary"><i class="fa fa-cog"></i></div> You have 4 pending tasks. <span class="text-muted">27 May</span>
                            </li>*@
                        @foreach (var review in Model.Reviews)
                        {
                            <li>
                                <div class="bg-light-info">
                                    <i class="fa fa-bell-o"></i>
                                </div>
                                <h5>@review.Title</h5>
                                @review.Text
                                <span class="text-muted">@review.DateCreated</span>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(document).ready(function () {
        var ratings = [];
        var orders = [];

        $.ajax({
            url: '/Factory/GetFactoryRatings',
            type: 'GET',
            contentType: 'application/json; charset=utf-8',
            data: { 'factoryId': 1 },
            cache: false,
            success: function (result) {
                console.log(result);
                ratings = result;


                var options = {
                    title: {
                        text: "Оцінки Компанії"
                    },
                    data: [{
                        type: "pie",
                        startAngle: 45,
                        showInLegend: "true",
                        legendText: "{label}",
                        indexLabel: "{label} ({y})",
                        yValueFormatString: "#,##0.#" % "",
                        dataPoints: [
                            { label: "1 зірка", y: ratings["1"] },
                            { label: "2 зірки", y: ratings["2"] },
                            { label: "3 зірки", y: ratings["3"] },
                            { label: "4 зірки", y: ratings["4"] },
                            { label: "5 зірок", y: ratings["5"] }
                        ]
                    }]
                };

                $("#pieChartContainer").CanvasJSChart(options);
            },
            error: function (result) {
            }
        });

        $.ajax({
            url: '/Factory/GetFactoryOrders',
            type: 'GET',
            contentType: 'application/json; charset=utf-8',
            data: { 'factoryId': 1 },
            cache: false,
            success: function (result) {
                console.log(result);
                
                $.each(result, function (key, value) {
                    console.log(key + ": " + value);
                    orders.push({ x: new Date(key), y: value });
                });

                var options = {
                    animationEnabled: true,
                    title: {
                        text: "Замовлення 2016 року"
                    },
                    axisX: {
                        valueFormatString: "MMM"
                    },
                    axisY: {
                        title: "Кількість замовлень",
                        //prefix: "$",
                        includeZero: false
                    },
                    data: [{
                        yValueFormatString: "#",
                        xValueFormatString: "MMMM",
                        type: "spline",
                        dataPoints:orders
                        //    [
                        //    { x: new Date(2017, 0), y: 25060 },
                        //    { x: new Date(2017, 1), y: 27980 },
                        //    { x: new Date(2017, 2), y: 33800 },
                        //    { x: new Date(2017, 3), y: 49400 },
                        //    { x: new Date(2017, 4), y: 40260 },
                        //    { x: new Date(2017, 5), y: 33900 },
                        //    { x: new Date(2017, 6), y: 48000 },
                        //    { x: new Date(2017, 7), y: 31500 },
                        //    { x: new Date(2017, 8), y: 32300 },
                        //    { x: new Date(2017, 9), y: 42000 },
                        //    { x: new Date(2017, 10), y: 52160 },
                        //    { x: new Date(2017, 11), y: 49400 }
                        //]
                    }]
                };

                $("#lineChart").CanvasJSChart(options);
            }
        });
    })
</script>
<script type="text/javascript" src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>